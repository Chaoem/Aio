<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>MP4 → VBEE Ngọc Huyền</title>
<script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.12.2/dist/ffmpeg.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/whisper-tiny/dist/whisper-tiny.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/translate.js@1.0.0/translate.min.js"></script>
</head>
<body>
<h2>MP4 → Video Việt Ngọc Huyền</h2>
<input type="file" id="videoInput" accept="video/*">
<br><br>
<button onclick="processVideo()">Chạy quy trình</button>
<p id="status"></p>

<script>
const { createFFmpeg, fetchFile } = FFmpeg;
const ffmpeg = createFFmpeg({ log:true });

let videoFile = null;

document.getElementById("videoInput").addEventListener("change", e=>{
    videoFile = e.target.files[0];
});

async function processVideo(){
    if(!videoFile) return alert("Chưa chọn video");
    const status = document.getElementById("status");

    status.innerText = "Đang load FFmpeg...";
    if(!ffmpeg.isLoaded()) await ffmpeg.load();

    const data = await fetchFile(videoFile);
    ffmpeg.FS('writeFile','input.mp4',data);

    status.innerText = "Tách MP3...";
    await ffmpeg.run('-i','input.mp4','-vn','-acodec','libmp3lame','audio.mp3');
    const audioData = ffmpeg.FS('readFile','audio.mp3');
    const mp3Blob = new Blob([audioData.buffer],{type:'audio/mpeg'});

    status.innerText = "Nhận diện giọng Trung...";
    const reader = new FileReader();
    reader.readAsArrayBuffer(mp3Blob);
    reader.onload = async ()=>{
        const text = await WhisperTiny.transcribe(new Uint8Array(reader.result), {language:"zh"});
        status.innerText = "Dịch sang tiếng Việt...";
        const vietText = await Translate(text,{from:"zh",to:"vi"});

        // --- VBEE API ---
        status.innerText = "Tạo giọng Ngọc Huyền trên VBEE...";
        const apiKey = "YOUR_VBEE_API_KEY"; // bạn cần key VBEE
        const response = await fetch("https://vbee.vn/api/tts",{
            method:"POST",
            headers: {"Content-Type":"application/json","Authorization":`Bearer ${apiKey}`},
            body: JSON.stringify({voice:"ngochuyen", text:vietText})
        });
        const json = await response.json();
        // json.url chứa file mp3 giọng Ngọc Huyền
        const mp3Url = json.url;

        status.innerText = "Tải audio VBEE...";
        const mp3Res = await fetch(mp3Url);
        const mp3Buffer = await mp3Res.arrayBuffer();
        ffmpeg.FS('writeFile','newaudio.mp3',new Uint8Array(mp3Buffer));

        status.innerText = "Ghép audio VBEE vào video...";
        await ffmpeg.run('-i','input.mp4','-i','newaudio.mp3','-c:v','copy','-map','0:v:0','-map','1:a:0','output.mp4');
        const outData = ffmpeg.FS('readFile','output.mp4');
        const blob = new Blob([outData.buffer],{type:'video/mp4'});

        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "video_vbee.mp4";
        a.click();

        status.innerText = "Hoàn tất! Video có giọng Ngọc Huyền";
    };
}
</script>
</body>
</html>        padding: 10px;
        font-size: 15px;
        resize: none;
    }

    .sidebar {
        width: 50%;
    }

    #console {
        background: black;
        height: 150px;
        padding: 10px;
        overflow-y: auto;
        border: 2px solid #333;
        font-size: 14px;
        white-space: pre-line;
    }

    /* Fake Script UI */
    #ui-display {
        margin-top: 20px;
        padding: 20px;
        border-radius: 12px;
        background: #1a1a1a;
        border: 2px solid #333;
        display: none;
    }

    .ui-window {
        background: #222;
        border-radius: 10px;
        padding: 15px;
        border: 1px solid #444;
    }

    .ui-title {
        font-size: 22px;
        color: #0f0;
        margin-bottom: 10px;
    }

    .ui-button {
        padding: 10px;
        background: #444;
        color: white;
        display: inline-block;
        margin-top: 8px;
        border-radius: 6px;
        cursor: pointer;
    }

    .btn {
        padding: 10px;
        background: #444;
        border: none;
        color: white;
        cursor: pointer;
        width: 100%;
        margin-bottom: 10px;
        border-radius: 5px;
    }
    .btn:hover {
        background: #555;
    }
</style>
</head>
<body>

<div class="topbar">Fake Roblox Executor</div>

<div class="container">
    <textarea id="scriptInput" placeholder="Paste script here..."></textarea>

    <div class="sidebar">
        <button class="btn" onclick="execute()">Execute</button>
        <div id="console">Console output...</div>

        <div id="ui-display"></div>
    </div>
</div>

<script>
function execute() {
    let consoleBox = document.getElementById("console");
    let uiBox = document.getElementById("ui-display");

    consoleBox.innerText += "\n[+] Executing script...";
    consoleBox.innerText += "\n[✓] Script executed successfully.";
    consoleBox.scrollTop = consoleBox.scrollHeight;

    // Always show default UI
    uiBox.style.display = "block";
    uiBox.innerHTML = `
        <div class="ui-window">
            <div class="ui-title">Example UI</div>
            <p>• This is a default fake UI</p>
            <p>• Loaded after Execute</p>

            <div class="ui-button">Toggle A</div>
            <div class="ui-button">Toggle B</div>
            <div class="ui-button">Button Action</div>
        </div>
    `;
}
</script>

</body>
</html>
